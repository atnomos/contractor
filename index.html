<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contractor Badge Maker</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background: #f8f9fa; }
    form { max-width: 600px; margin: auto; }
    input, textarea { width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; }
    .artwork-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin: 20px 0;
    }
    .artwork-grid label {
      cursor: pointer;
      border: 2px solid transparent;
      border-radius: 6px;
      padding: 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      color: #555;
    }
    .artwork-grid input:checked + label {
      border-color: #007bff;
      color: #007bff;
    }
    #preview {
      margin: 30px auto;
      width: 400px;
      height: 400px;
      border: 1px solid #ddd;
      position: relative;
      background: #fff; /* fallback */
      overflow: hidden;
    }
    button {
      padding: 12px 24px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
    #textOverlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      text-shadow: 2px 2px 6px #000;
      text-align: center;
      width: 90%;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <h1>Contractor Shoutout Badge</h1>

  <form id="form">
    <input type="text" id="name" placeholder="Contractor's Name" required />
    <textarea id="reason" rows="3" placeholder="What are we celebrating?" required></textarea>

    <div class="artwork-grid">
      <input type="radio" name="artwork" value="image1" id="image1" checked />
      <label for="image1">
        <img src="images/image1.png" alt="Badge 1 – Excellence / Great Job" width="80" height="80" />
        <span>Excellence</span>
      </label>

      <input type="radio" name="artwork" value="image2" id="image2" />
      <label for="image2">
        <img src="images/image2.png" alt="Badge 2 – Reliability / Solid Work" width="80" height="80" />
        <span>Reliability</span>
      </label>

      <input type="radio" name="artwork" value="image3" id="image3" />
      <label for="image3">
        <img src="images/image3.png" alt="Badge 3 – Teamwork / Collaboration" width="80" height="80" />
        <span>Teamwork</span>
      </label>

      <input type="radio" name="artwork" value="image4" id="image4" />
      <label for="image4">
        <img src="images/image4.png" alt="Badge 4 – Innovation / Above & Beyond" width="80" height="80" />
        <span>Innovation</span>
      </label>

      <input type="radio" name="artwork" value="image5" id="image5" />
      <label for="image5">
        <img src="images/image5.png" alt="Badge 5 – Achievement / Extra Mile" width="80" height="80" />
        <span>Achievement</span>
      </label>
    </div>

    <button type="button" id="generate">Generate & Download</button>
  </form>

  <div id="preview">
    <img id="bg" src="" style="width:100%; height:100%; object-fit:cover; position:absolute;" alt="Badge background" />
    <div id="textOverlay">
      <div id="nameText" style="font: bold 32px Arial; margin-bottom: 12px;"></div>
      <div id="reasonText" style="font: 24px Arial; line-height: 1.3;"></div>
    </div>
  </div>

  <script>
    const nameInput   = document.getElementById('name');
    const reasonInput = document.getElementById('reason');
    const previewBg   = document.getElementById('bg');
    const nameText    = document.getElementById('nameText');
    const reasonText  = document.getElementById('reasonText');

    // Live text update
    nameInput.addEventListener('input',   () => nameText.textContent   = nameInput.value.trim());
    reasonInput.addEventListener('input', () => reasonText.textContent = reasonInput.value.trim());

    // Artwork selection + initial load
    document.querySelectorAll('input[name="artwork"]').forEach(radio => {
      radio.addEventListener('change', () => {
        const img = radio.nextElementSibling.querySelector('img');
        previewBg.src = img.src;
      });
    });

    // Set initial background (default checked radio)
    const initialImg = document.querySelector('input[name="artwork"]:checked + label img');
    if (initialImg) previewBg.src = initialImg.src;

    // Generate & download
    document.getElementById('generate').onclick = () => {
      if (!nameInput.value.trim() || !reasonInput.value.trim()) {
        alert('Please enter both name and reason.');
        return;
      }

      const canvas = document.createElement('canvas');
      canvas.width = 400;
      canvas.height = 400;
      const ctx = canvas.getContext('2d');

      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.src = previewBg.src;

      img.onload = () => {
        ctx.drawImage(img, 0, 0, 400, 400);

        // Text styling
        ctx.textAlign = 'center';
        ctx.fillStyle = '#ffffff';
        ctx.shadowColor = 'rgba(0,0,0,0.8)';
        ctx.shadowBlur = 6;
        ctx.shadowOffsetX = 2;
        ctx.shadowOffsetY = 2;

        // Name (larger, bolder)
        ctx.font = 'bold 34px Arial';
        ctx.fillText(nameInput.value.trim(), 200, 160);

        // Reason (smaller, can wrap a bit better)
        ctx.font = '24px Arial';
        ctx.fillText(reasonInput.value.trim(), 200, 220);

        // Download
        const link = document.createElement('a');
        link.download = 'contractor_shoutout_badge.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      };

      img.onerror = () => alert('Failed to load background image. Check file paths.');
    };
  </script>
</body>
</html>