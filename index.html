<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contractor Shoutout Badge Maker</title>
  <style>
    :root {
      --primary: #0066cc;
      --primary-dark: #004c99;
      --text: #f8f9ff;
      --gray: #b0c4de;
      --shadow: 0 6px 20px rgba(0,0,0,0.6);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      min-height: 100vh;
      color: var(--text);
      background: #000814;
      position: relative;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .space-bg { position: fixed; inset: 0; background: #000814; z-index: -3; }

    .stars, .stars2 { position: fixed; inset: 0; background: transparent; z-index: -2; filter: blur(3px); opacity: 0.35; }
    .stars {
      background-image: 
        radial-gradient(circle, rgba(255,255,255,0.8) 1.5px, transparent 12px),
        radial-gradient(circle, rgba(240,245,255,0.6) 1.2px, transparent 15px);
      background-size: 900px 900px, 1100px 1100px;
      animation: slow-drift 700s linear infinite;
    }
    .stars2 {
      background-image: radial-gradient(circle, rgba(255,255,255,0.5) 1px, transparent 18px);
      background-size: 1300px 1300px;
      animation: slow-drift 1000s linear infinite reverse;
    }

    @keyframes slow-drift { from { transform: translate(0, 0); } to { transform: translate(-100px, -100px); } }

    .twinkle {
      position: fixed; inset: 0; background: transparent;
      box-shadow: 900px 300px 8px rgba(255,255,255,0.25), 400px 700px 10px rgba(240,245,255,0.2);
      opacity: 0.4; animation: gentle-twinkle 30s infinite ease-in-out;
      pointer-events: none; z-index: -1; filter: blur(4px);
    }
    @keyframes gentle-twinkle { 0%,100% { opacity: 0.4; } 50% { opacity: 0.7; } }

    .container {
      position: relative;
      max-width: 720px; width: 100%; margin: 40px auto; padding: 32px 24px;
      background: rgba(0, 4, 15, 0.7); backdrop-filter: blur(12px);
      border-radius: 20px; border: 1px solid rgba(255,255,255,0.06);
      box-shadow: var(--shadow); z-index: 1;
    }

    h1 { font-size: 2.6rem; color: #f8f9ff; text-align: center; margin-bottom: 16px; text-shadow: 0 0 20px rgba(255,255,255,0.2); }

    .intro { color: var(--gray); text-align: center; margin-bottom: 32px; font-size: 1.1rem; }

    label { display: block; margin: 0 0 8px; font-weight: 600; color: #d0e0ff; }

    input[type="text"], textarea {
      width: 100%; padding: 14px 16px; border: 1px solid rgba(255,255,255,0.15);
      border-radius: 10px; background: rgba(255,255,255,0.02); color: white;
      font-size: 1rem; transition: all 0.25s;
    }

    input:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(0,102,204,0.15); outline: none; }

    textarea { min-height: 110px; resize: vertical; }

    .reason-counter {
      text-align: right; font-size: 0.85rem; color: #88aaff; margin-top: 4px;
      opacity: 0.8;
    }

    .artwork-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 20px; margin: 32px 0; }

    .artwork-option label {
      display: flex; flex-direction: column; align-items: center; gap: 10px;
      padding: 14px; border: 2px solid rgba(255,255,255,0.12); border-radius: 14px;
      background: rgba(255,255,255,0.015); transition: all 0.3s ease; cursor: pointer;
    }

    .artwork-option input:checked + label {
      border-color: var(--primary); background: rgba(0,102,204,0.08);
      box-shadow: 0 0 20px rgba(0,102,204,0.25); transform: scale(1.08);
    }

    .artwork-option img { width: 100px; height: 100px; object-fit: contain; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.6); transition: transform 0.3s; }

    .artwork-option:hover img { transform: scale(1.15); }

    .artwork-option span { font-size: 0.95rem; color: #d0e0ff; }

    #preview {
      margin: 40px auto; width: 100%; max-width: 440px; aspect-ratio: 1;
      border: 1px solid rgba(255,255,255,0.1); border-radius: 18px; overflow: hidden;
      position: relative; box-shadow: 0 12px 40px rgba(0,0,0,0.7); background: rgba(0,0,0,0.5);
    }

    #bg { width: 100%; height: 100%; object-fit: cover; position: absolute; inset: 0; }

    #textOverlay {
      position: absolute; inset: 0; display: flex; flex-direction: column;
      justify-content: center; align-items: center; padding: 24px; text-align: center;
      text-shadow: 0 4px 16px rgba(0,0,0,0.98); pointer-events: none;
    }

    #nameText { font: bold 44px Arial, sans-serif; margin-bottom: 16px; line-height: 1.05; }
    #reasonText { font: 26px Arial, sans-serif; line-height: 1.35; max-width: 88%; }

    .actions { display: flex; gap: 16px; justify-content: center; margin-top: 32px; flex-wrap: wrap; }

    button, .copy-btn {
      padding: 14px 28px; border: none; border-radius: 10px; cursor: pointer;
      font-size: 1.05rem; font-weight: 600; transition: all 0.25s;
    }

    button {
      background: linear-gradient(135deg, #0066cc, #0077ff); color: white;
      box-shadow: 0 6px 20px rgba(0,102,204,0.4);
    }

    button:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0,102,204,0.5); }

    .copy-btn {
      background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2);
    }

    .copy-btn:hover { background: rgba(255,255,255,0.18); }

    button:disabled, .copy-btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .spinner {
      display: none; margin-left: 12px; width: 20px; height: 20px;
      border: 3px solid rgba(255,255,255,0.3); border-top: 3px solid white;
      border-radius: 50%; animation: spin 1s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    @media (max-width: 520px) {
      h1 { font-size: 2.1rem; }
      #preview { max-width: 360px; }
      #nameText { font-size: 36px; }
      #reasonText { font-size: 22px; }
      .container { padding: 24px 16px; margin: 20px auto; }
      .actions { flex-direction: column; gap: 12px; }
    }
  </style>
</head>
<body>
  <div class="space-bg"></div>
  <div class="stars"></div>
  <div class="twinkle"></div>

  <div class="container">
    <h1>Contractor Shoutout Badge</h1>
    <p class="intro">Create a quick recognition badge â€” fill in the details, pick a style, then download to share on Teams!</p>

    <form id="form">
      <label for="name">Contractor's Name</label>
      <input type="text" id="name" placeholder="e.g. Alex Rivera" required />

      <label for="reason">What are we celebrating? <span class="reason-counter" id="counter">0/120</span></label>
      <textarea id="reason" rows="3" placeholder="e.g. Outstanding support on the Q4 migration project!" maxlength="120" required></textarea>

      <label>Choose a badge style</label>
      <div class="artwork-grid">
        <div class="artwork-option">
          <input type="radio" name="artwork" value="image1" id="image1" checked />
          <label for="image1"><img src="images/image1.png" alt="Excellence Badge" /><span>Excellence</span></label>
        </div>
        <div class="artwork-option">
          <input type="radio" name="artwork" value="image2" id="image2" />
          <label for="image2"><img src="images/image2.png" alt="Reliability Badge" /><span>Reliability</span></label>
        </div>
        <div class="artwork-option">
          <input type="radio" name="artwork" value="image3" id="image3" />
          <label for="image3"><img src="images/image3.png" alt="Teamwork Badge" /><span>Teamwork</span></label>
        </div>
        <div class="artwork-option">
          <input type="radio" name="artwork" value="image4" id="image4" />
          <label for="image4"><img src="images/image4.png" alt="Innovation Badge" /><span>Innovation</span></label>
        </div>
        <div class="artwork-option">
          <input type="radio" name="artwork" value="image5" id="image5" />
          <label for="image5"><img src="images/image5.png" alt="Achievement Badge" /><span>Achievement</span></label>
        </div>
      </div>

      <div class="actions">
        <button type="button" id="generate">
          Generate & Download Badge
          <span class="spinner" id="spinner"></span>
        </button>
        <button type="button" class="copy-btn" id="copyBtn" disabled>Copy to Clipboard</button>
      </div>
    </form>

    <div id="preview" aria-label="Badge preview">
      <img id="bg" src="" alt="Selected badge background" />
      <div id="textOverlay">
        <div id="nameText"></div>
        <div id="reasonText"></div>
      </div>
    </div>
  </div>

  <script>
    const nameInput    = document.getElementById('name');
    const reasonInput  = document.getElementById('reason');
    const counter      = document.getElementById('counter');
    const previewBg    = document.getElementById('bg');
    const nameText     = document.getElementById('nameText');
    const reasonText   = document.getElementById('reasonText');
    const generateBtn  = document.getElementById('generate');
    const spinner      = document.getElementById('spinner');
    const copyBtn      = document.getElementById('copyBtn');

    // Live preview text
    nameInput.addEventListener('input',   () => nameText.textContent   = nameInput.value.trim());
    reasonInput.addEventListener('input', () => {
      reasonText.textContent = reasonInput.value.trim();
      counter.textContent = `${reasonInput.value.length}/120`;
      counter.style.color = reasonInput.value.length > 100 ? '#ff6b6b' : '#88aaff';
    });

    // Artwork switch
    document.querySelectorAll('input[name="artwork"]').forEach(radio => {
      radio.addEventListener('change', () => {
        const img = radio.nextElementSibling.querySelector('img');
        previewBg.src = img.src;
      });
    });

    const initialImg = document.querySelector('input[name="artwork"]:checked + label img');
    if (initialImg) previewBg.src = initialImg.src;

    // Generate
    generateBtn.onclick = async () => {
      if (!nameInput.value.trim() || !reasonInput.value.trim()) {
        alert('Please enter both name and celebration reason.');
        return;
      }

      generateBtn.disabled = true;
      copyBtn.disabled = true;
      spinner.style.display = 'inline-block';

      const canvas = document.createElement('canvas');
      canvas.width = 400; canvas.height = 400;
      const ctx = canvas.getContext('2d');

      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.src = previewBg.src;

      img.onload = () => {
        ctx.drawImage(img, 0, 0, 400, 400);

        ctx.textAlign = 'center';
        ctx.fillStyle = '#ffffff';
        ctx.shadowColor = 'rgba(0,0,0,0.98)';
        ctx.shadowBlur = 12;
        ctx.shadowOffsetX = 3;
        ctx.shadowOffsetY = 3;

        ctx.font = 'bold 44px Arial, sans-serif';
        ctx.fillText(nameInput.value.trim(), 200, 160);

        ctx.font = '26px Arial, sans-serif';
        ctx.fillText(reasonInput.value.trim(), 200, 225);

        const dataUrl = canvas.toDataURL('image/png');

        // Download
        const link = document.createElement('a');
        link.download = `shoutout_${nameInput.value.trim().replace(/\s+/g,'_') || 'badge'}.png`;
        link.href = dataUrl;
        link.click();

        // Enable copy
        copyBtn.disabled = false;
        copyBtn.dataset.url = dataUrl;

        // Reset UI
        generateBtn.disabled = false;
        spinner.style.display = 'none';
      };

      img.onerror = () => {
        alert('Failed to load background image.');
        generateBtn.disabled = false;
        spinner.style.display = 'none';
      };
    };

    // Copy to clipboard
    copyBtn.onclick = async () => {
      if (!copyBtn.dataset.url) return;

      try {
        const blob = await (await fetch(copyBtn.dataset.url)).blob();
        await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);
        copyBtn.textContent = 'Copied!';
        setTimeout(() => { copyBtn.textContent = 'Copy to Clipboard'; }, 2000);
      } catch (err) {
        alert('Copy failed. Try downloading instead.');
      }
    };
  </script>
</body>
</html>
